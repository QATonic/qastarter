package {{javaPackage}}.core;

import io.restassured.RestAssured;
import io.restassured.response.Response;
import io.restassured.specification.RequestSpecification;
import {{javaPackage}}.config.ConfigReader;
import {{javaPackage}}.utils.Log;

import static io.restassured.RestAssured.given;

/**
 * API Client - Simplified HTTP client for REST API testing.
 * 
 * Sample API: JSONPlaceholder (https://jsonplaceholder.typicode.com)
 * 
 * Usage:
 *   APIClient api = new APIClient();
 *   Response response = api.get("/users");
 *   Response response = api.post("/users", userObject);
 */
public class APIClient {

    public APIClient() {
        RestAssured.baseURI = ConfigReader.getBaseUrl();
        Log.info("API Client initialized with base URL: " + RestAssured.baseURI);
    }

    private RequestSpecification getRequestSpec() {
        return given()
            .contentType(ConfigReader.getContentType())
            .accept(ConfigReader.getContentType())
            .log().all();
    }

    /**
     * GET request
     */
    public Response get(String endpoint) {
        Log.info("GET " + endpoint);
        Response response = getRequestSpec().get(endpoint);
        Log.info("Response: " + response.getStatusCode());
        return response;
    }

    /**
     * POST request with body
     */
    public Response post(String endpoint, Object body) {
        Log.info("POST " + endpoint);
        Response response = getRequestSpec().body(body).post(endpoint);
        Log.info("Response: " + response.getStatusCode());
        return response;
    }

    /**
     * PUT request with body
     */
    public Response put(String endpoint, Object body) {
        Log.info("PUT " + endpoint);
        Response response = getRequestSpec().body(body).put(endpoint);
        Log.info("Response: " + response.getStatusCode());
        return response;
    }

    /**
     * PATCH request with body
     */
    public Response patch(String endpoint, Object body) {
        Log.info("PATCH " + endpoint);
        Response response = getRequestSpec().body(body).patch(endpoint);
        Log.info("Response: " + response.getStatusCode());
        return response;
    }

    /**
     * DELETE request
     */
    public Response delete(String endpoint) {
        Log.info("DELETE " + endpoint);
        Response response = getRequestSpec().delete(endpoint);
        Log.info("Response: " + response.getStatusCode());
        return response;
    }

    /**
     * GET with path parameter
     */
    public Response get(String endpoint, int id) {
        return get(endpoint + "/" + id);
    }

    /**
     * PUT with path parameter
     */
    public Response put(String endpoint, int id, Object body) {
        return put(endpoint + "/" + id, body);
    }

    /**
     * DELETE with path parameter
     */
    public Response delete(String endpoint, int id) {
        return delete(endpoint + "/" + id);
    }
}