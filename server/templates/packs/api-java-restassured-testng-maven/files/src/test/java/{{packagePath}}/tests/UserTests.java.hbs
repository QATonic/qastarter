package {{javaPackage}}.tests;

import io.restassured.response.Response;
import org.testng.annotations.Test;
import {{javaPackage}}.core.BaseTest;
import {{javaPackage}}.core.ResponseValidator;
import {{javaPackage}}.models.User;
import {{javaPackage}}.utils.Log;

import java.util.List;

/**
 * User API Tests - CRUD operations against JSONPlaceholder /users.
 * 
 * Run: mvn clean test
 */
public class UserTests extends BaseTest {

    @Test(priority = 1, description = "GET all users")
    public void testGetAllUsers() {
        Log.step("GET all users from /users");
        
        Response response = get(USERS_ENDPOINT);
        
        ResponseValidator.assertStatus(response, 200);
        ResponseValidator.assertBodyNotEmpty(response);
        
        List<?> users = response.jsonPath().getList("$");
        Log.info("Total users: " + users.size());
    }

    @Test(priority = 2, description = "GET single user by ID")
    public void testGetSingleUser() {
        Log.step("GET user with ID 1");
        
        Response response = get(USERS_ENDPOINT, 1);
        
        ResponseValidator.assertStatus(response, 200);
        ResponseValidator.assertBodyContains(response, "email");
        
        String name = response.jsonPath().getString("name");
        Log.info("User name: " + name);
    }

    @Test(priority = 3, description = "POST create new user")
    public void testCreateUser() {
        Log.step("POST create new user");
        
        User newUser = new User("John Doe", "johndoe", "john@example.com");
        Response response = post(USERS_ENDPOINT, newUser);
        
        ResponseValidator.assertStatus(response, 201);
        
        int createdId = ResponseValidator.extractIntValue(response, "id");
        Log.info("Created user ID: " + createdId);
    }

    @Test(priority = 4, description = "PUT update existing user")
    public void testUpdateUser() {
        Log.step("PUT update user with ID 1");
        
        User updatedUser = new User("Jane Doe", "janedoe", "jane@example.com");
        Response response = put(USERS_ENDPOINT, 1, updatedUser);
        
        ResponseValidator.assertStatus(response, 200);
        ResponseValidator.assertBodyContains(response, "janedoe");
    }

    @Test(priority = 5, description = "DELETE user by ID")
    public void testDeleteUser() {
        Log.step("DELETE user with ID 1");
        
        Response response = delete(USERS_ENDPOINT, 1);
        
        ResponseValidator.assertStatus(response, 200);
        Log.info("User deleted successfully");
    }
}