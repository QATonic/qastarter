using OpenQA.Selenium;
using OpenQA.Selenium.Appium.Windows;
using {{projectName}}.Core;

namespace {{projectName}}.Pages;

public abstract class BasePage
{
    protected WindowsDriver<WindowsElement> Driver;

    protected BasePage(WindowsDriver<WindowsElement> driver)
    {
        Driver = driver;
    }

    protected WindowsElement FindElement(By locator)
    {
        return Driver.FindElement(locator) as WindowsElement 
            ?? throw new NoSuchElementException($"Element not found: {locator}");
    }

    protected WindowsElement WaitForElement(By locator, int timeoutSeconds = -1)
    {
        return WaitHelpers.WaitForElement(Driver, locator, timeoutSeconds);
    }

    protected void Click(WindowsElement element, string elementName = "Element")
    {
        ElementActions.Click(element, elementName);
    }

    protected void SendKeys(WindowsElement element, string text, string elementName = "Element")
    {
        ElementActions.SendKeys(element, text, elementName);
    }

    protected string GetText(WindowsElement element, string elementName = "Element")
    {
        return ElementActions.GetText(element, elementName);
    }

    protected string GetAttribute(WindowsElement element, string attributeName, string elementName = "Element")
    {
        return ElementActions.GetAttribute(element, attributeName, elementName);
    }
}
