from selenium.webdriver.common.by import By
from pages.base_page import BasePage
from utils.logger import log


class CalculatorPage(BasePage):
    BUTTON_ONE = (By.NAME, "One")
    BUTTON_TWO = (By.NAME, "Two")
    BUTTON_THREE = (By.NAME, "Three")
    BUTTON_PLUS = (By.NAME, "Plus")
    BUTTON_EQUALS = (By.NAME, "Equals")
    RESULT_DISPLAY = (By.ACCESSIBILITY_ID, "CalculatorResults")

    def click_number(self, number: int):
        button = (By.NAME, str(number) if number > 3 else ["One", "Two", "Three"][number-1])
        self.click(button)
        return self

    def click_plus(self): self.click(self.BUTTON_PLUS); return self
    def click_equals(self): self.click(self.BUTTON_EQUALS); return self
    def get_result(self): return self.get_text(self.RESULT_DISPLAY)

    def add(self, a: int, b: int):
        log.step(f"Calculate: {a} + {b}")
        self.click((By.NAME, ["One", "Two", "Three", "Four", "Five"][a-1]))
        self.click_plus()
        self.click((By.NAME, ["One", "Two", "Three", "Four", "Five"][b-1]))
        self.click_equals()
        return self