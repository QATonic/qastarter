package {{packageName}}.tests;

import {{packageName}}.base.BaseTest;
import {{packageName}}.screens.HomeScreen;
import {{packageName}}.screens.LoginScreen;
import {{packageName}}.utils.Log;
import {{packageName}}.utils.TestDataReader;

import org.junit.Before;
import org.junit.Test;

import java.util.Map;

import static org.junit.Assert.assertTrue;

/**
 * Login functionality tests.
 * 
 * ========== IMPORTANT: BEFORE RUNNING ==========
 * 1. Update view IDs in LoginScreen.java and HomeScreen.java
 * 2. Update test data in assets/testdata/users.json
 * 3. Update the activity launch in setUp() method
 * ================================================
 */
public class LoginTests extends BaseTest {

    private LoginScreen loginScreen;
    private HomeScreen homeScreen;

    @Before
    public void setUp() {
        super.baseSetUp();
        
        // TODO: Launch your login activity here
        // Example: launchActivity(LoginActivity.class);
        
        loginScreen = new LoginScreen();
        homeScreen = new HomeScreen();
        
        Log.info("Login tests setup complete");
    }

    /**
     * Test successful login with valid credentials.
     * 
     * Steps:
     * 1. Enter valid username
     * 2. Enter valid password
     * 3. Click login button
     * 4. Verify home screen is displayed
     */
    @Test
    public void testSuccessfulLogin() {
        Log.testStart("testSuccessfulLogin");
        
        // Get test data
        Map<String, String> validUser = TestDataReader.getTestUser("validUser");
        
        // Perform login
        loginScreen.login(
            validUser.get("username"),
            validUser.get("password")
        );
        
        // Verify home screen is displayed
        assertTrue("Home screen should be displayed after successful login",
                homeScreen.isLoaded());
        
        Log.testEnd("testSuccessfulLogin", true);
    }

    /**
     * Test login with invalid credentials.
     * 
     * Steps:
     * 1. Enter invalid username
     * 2. Enter invalid password
     * 3. Click login button
     * 4. Verify error message is displayed
     */
    @Test
    public void testInvalidLogin() {
        Log.testStart("testInvalidLogin");
        
        // Get test data
        Map<String, String> invalidUser = TestDataReader.getTestUser("invalidUser");
        
        // Perform login with invalid credentials
        loginScreen.login(
            invalidUser.get("username"),
            invalidUser.get("password")
        );
        
        // Verify error is displayed
        loginScreen.verifyErrorDisplayed();
        
        Log.testEnd("testInvalidLogin", true);
    }

    /**
     * Test login with empty credentials.
     * 
     * Steps:
     * 1. Leave username empty
     * 2. Leave password empty
     * 3. Click login button
     * 4. Verify validation error is displayed
     */
    @Test
    public void testEmptyCredentials() {
        Log.testStart("testEmptyCredentials");
        
        // Clear any existing text
        loginScreen.clearForm();
        
        // Try to login with empty fields
        loginScreen.clickLogin();
        
        // Verify error is displayed
        loginScreen.verifyErrorDisplayed();
        
        Log.testEnd("testEmptyCredentials", true);
    }

    /**
     * Test login with empty password.
     */
    @Test
    public void testEmptyPassword() {
        Log.testStart("testEmptyPassword");
        
        Map<String, String> validUser = TestDataReader.getTestUser("validUser");
        
        loginScreen
            .enterUsername(validUser.get("username"))
            .clickLogin();
        
        loginScreen.verifyErrorDisplayed();
        
        Log.testEnd("testEmptyPassword", true);
    }
}
