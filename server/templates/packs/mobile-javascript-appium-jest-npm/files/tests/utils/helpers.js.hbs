const fs = require('fs');
const path = require('path');

function loadJsonFile(filePath) {
  const data = fs.readFileSync(filePath, 'utf8');
  return JSON.parse(data);
}

async function saveScreenshot(driver, name) {
  const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
  const screenshotPath = path.join('screenshots', `${name}_${timestamp}.png`);
  
  if (!fs.existsSync('screenshots')) {
    fs.mkdirSync('screenshots', { recursive: true });
  }
  
  await driver.saveScreenshot(screenshotPath);
  return screenshotPath;
}

function getPlatform() {
  return (process.env.PLATFORM || 'Android').toLowerCase();
}

function isAndroid() {
  return getPlatform() === 'android';
}

function isIOS() {
  return getPlatform() === 'ios';
}

module.exports = {
  loadJsonFile,
  saveScreenshot,
  getPlatform,
  isAndroid,
  isIOS
};
