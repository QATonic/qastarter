package {{javaPackage}}.pages;

import {{javaPackage}}.utils.Log;

/**
 * Home Page Object.
 * Contains locators and methods for home page interactions.
 */
public class HomePage extends BasePage {
    
    // Locators
    private final String welcomeMessage = ".welcome-message, h1, .greeting";
    private final String logoutButton = "button:has-text('Logout'), a:has-text('Logout'), .logout";
    private final String userProfile = ".user-profile, .profile, .user-info";
    private final String navigation = "nav, .navigation, .navbar";
    private final String dashboardLink = "a:has-text('Dashboard')";
    private final String settingsLink = "a:has-text('Settings')";
    private final String notificationIcon = ".notification-icon, .notifications";
    private final String searchBox = "input[type='search'], .search-input";
    
    /**
     * Check if home page is loaded
     * @return true if page is loaded
     */
    @Override
    public boolean isLoaded() {
        try {
            // Wait for key elements that indicate home page is loaded
            waitForVisible(welcomeMessage);
            return true;
        } catch (Exception e) {
            Log.error("Home page not loaded", e);
            return false;
        }
    }
    
    /**
     * Get welcome message text
     * @return Welcome message
     */
    public String getWelcomeMessage() {
        Log.info("Getting welcome message");
        return getText(welcomeMessage);
    }
    
    /**
     * Check if user is logged in by verifying logout button
     * @return true if logout button is visible
     */
    public boolean isUserLoggedIn() {
        return isVisible(logoutButton);
    }
    
    /**
     * Check if specific user is logged in
     * @param username Expected username
     * @return true if username is displayed
     */
    public boolean isUserLoggedIn(String username) {
        try {
            String welcomeText = getWelcomeMessage();
            return welcomeText.contains(username);
        } catch (Exception e) {
            Log.warn("Could not verify username in welcome message");
            return false;
        }
    }
    
    /**
     * Click logout button
     * @return LoginPage
     */
    public LoginPage logout() {
        Log.info("Clicking logout button");
        click(logoutButton);
        return new LoginPage();
    }
    
    /**
     * Check if navigation menu is visible
     * @return true if visible
     */
    public boolean isNavigationVisible() {
        return isVisible(navigation);
    }
    
    /**
     * Click dashboard link
     */
    public void clickDashboard() {
        Log.info("Clicking dashboard link");
        click(dashboardLink);
    }
    
    /**
     * Click settings link
     */
    public void clickSettings() {
        Log.info("Clicking settings link");
        click(settingsLink);
    }
    
    /**
     * Check if notification icon is visible
     * @return true if visible
     */
    public boolean isNotificationIconVisible() {
        return isVisible(notificationIcon);
    }
    
    /**
     * Click notification icon
     */
    public void clickNotificationIcon() {
        Log.info("Clicking notification icon");
        click(notificationIcon);
    }
    
    /**
     * Search for text
     * @param searchText Text to search
     */
    public void search(String searchText) {
        Log.info("Searching for: " + searchText);
        fill(searchBox, searchText);
        page.keyboard().press("Enter");
    }
    
    /**
     * Check if user profile is visible
     * @return true if visible
     */
    public boolean isUserProfileVisible() {
        return isVisible(userProfile);
    }
    
    /**
     * Click on user profile
     */
    public void clickUserProfile() {
        Log.info("Clicking user profile");
        click(userProfile);
    }
    
    /**
     * Get page header text
     * @return Header text
     */
    public String getPageHeader() {
        return getText("h1");
    }
}
