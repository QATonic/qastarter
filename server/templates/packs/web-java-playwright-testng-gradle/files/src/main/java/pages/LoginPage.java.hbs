package pages;

import com.microsoft.playwright.Page;
import config.EnvConfig;

public class LoginPage extends BasePage {
    private final String USERNAME_INPUT = "#username";
    private final String PASSWORD_INPUT = "#password";
    private final String LOGIN_BUTTON = "button[type='submit']";
    private final String ERROR_MESSAGE = ".error-message";
    private final String SUCCESS_INDICATOR = ".dashboard, .home";

    public LoginPage(Page page) {
        super(page);
    }

    public void navigateToLogin() {
        navigate(EnvConfig.getInstance().getBaseUrl() + "/login");
    }

    public void login(String username, String password) {
        type(USERNAME_INPUT, username);
        type(PASSWORD_INPUT, password);
        click(LOGIN_BUTTON);
    }

    public boolean isLoginSuccessful() {
        try {
            waitForSelector(SUCCESS_INDICATOR, 10000);
            return true;
        } catch (Exception e) {
            return false;
        }
    }

    public boolean isErrorDisplayed() {
        return isVisible(ERROR_MESSAGE);
    }

    public String getErrorMessage() {
        return getText(ERROR_MESSAGE);
    }

    public boolean isUsernameVisible() {
        return isVisible(USERNAME_INPUT);
    }

    public boolean isPasswordVisible() {
        return isVisible(PASSWORD_INPUT);
    }
}
