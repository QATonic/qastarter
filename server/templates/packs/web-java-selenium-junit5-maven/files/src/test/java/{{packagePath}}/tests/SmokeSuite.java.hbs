package {{javaPackage}}.tests;

import {{javaPackage}}.core.BaseTest;
import {{javaPackage}}.listeners.TestWatcher;
import {{javaPackage}}.pages.HomePage;
import {{javaPackage}}.pages.LoginPage;
import org.junit.jupiter.api.*;
import org.junit.jupiter.api.extension.ExtendWith;

import static org.junit.jupiter.api.Assertions.*;

/**
 * Smoke test suite for critical functionality.
 * These tests should run quickly and verify basic functionality.
 */
@ExtendWith(TestWatcher.class)
@DisplayName("Smoke Test Suite")
@Tag("smoke")
public class SmokeSuite extends BaseTest {
    
    @Test
    @DisplayName("Verify application is accessible")
    public void testApplicationAccessible() {
        // Verify the application loaded
        String currentUrl = getCurrentUrl();
        assertNotNull(currentUrl, "Current URL should not be null");
        
        // Verify page title is present
        String pageTitle = getPageTitle();
        assertNotNull(pageTitle, "Page title should not be null");
        assertFalse(pageTitle.isEmpty(), "Page title should not be empty");
    }
    
    @Test
    @DisplayName("Verify login page loads")
    public void testLoginPageLoads() {
        LoginPage loginPage = new LoginPage();
        
        // Verify login page is loaded
        assertTrue(loginPage.isLoaded(), "Login page should be loaded");
        
        // Verify essential elements are present
        assertTrue(loginPage.validatePageElements(), 
                  "Login page elements should be present");
    }
    
    @Test
    @DisplayName("Verify successful login and logout flow")
    public void testLoginLogoutFlow() {
        LoginPage loginPage = new LoginPage();
        
        // Verify login page is loaded
        assertTrue(loginPage.isLoaded(), "Login page should be loaded");
        
        // Perform login
        HomePage homePage = loginPage.login("admin", "password123", HomePage.class);
        
        // Verify successful login
        assertTrue(homePage.isLoaded(), "Home page should be loaded after login");
        assertTrue(homePage.isUserLoggedIn("admin"), "User should be logged in");
        
        // Perform logout
        LoginPage logoutPage = homePage.logout();
        
        // Verify successful logout
        assertTrue(logoutPage.isLoaded(), 
                  "Should return to login page after logout");
    }
    
    @Test
    @DisplayName("Verify invalid login is rejected")
    public void testInvalidLoginRejected() {
        LoginPage loginPage = new LoginPage();
        
        // Verify login page is loaded
        assertTrue(loginPage.isLoaded(), "Login page should be loaded");
        
        // Attempt login with invalid credentials
        LoginPage resultPage = loginPage.login("invalid", "wrongpass", LoginPage.class);
        
        // Verify login failed
        assertTrue(resultPage.isLoaded(), 
                  "Should stay on login page after failed login");
        assertTrue(resultPage.isErrorMessageDisplayed(), 
                  "Error message should be displayed for invalid login");
    }
    
    @Test
    @DisplayName("Verify critical navigation links work")
    public void testCriticalNavigation() {
        LoginPage loginPage = new LoginPage();
        HomePage homePage = loginPage.login("admin", "password123", HomePage.class);
        
        // Verify home page loaded
        assertTrue(homePage.isLoaded(), "Home page should be loaded");
        
        // Test navigation (add more as needed based on your app)
        assertTrue(homePage.validateNavigationElements(), 
                  "Navigation elements should be present and functional");
    }
    
    @Test
    @DisplayName("Verify browser navigation functions")
    public void testBrowserNavigation() {
        LoginPage loginPage = new LoginPage();
        
        // Navigate to home (or another page)
        String baseUrl = getBaseUrl();
        navigateTo(baseUrl);
        
        // Navigate forward and back
        String initialUrl = getCurrentUrl();
        
        // Navigate to login
        navigateTo(baseUrl + "/login");
        String loginUrl = getCurrentUrl();
        
        assertNotEquals(initialUrl, loginUrl, 
                       "URL should change after navigation");
        
        // Navigate back
        navigateBack();
        assertEquals(initialUrl, getCurrentUrl(), 
                    "Should return to initial URL after back navigation");
        
        // Navigate forward
        navigateForward();
        assertEquals(loginUrl, getCurrentUrl(), 
                    "Should return to login URL after forward navigation");
    }
}
