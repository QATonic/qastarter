const fs = require('fs');
const path = require('path');

class ScreenshotHelper {
  constructor(driver) {
    this.driver = driver;
    this.screenshotDir = path.join(process.cwd(), 'screenshots');
    
    if (!fs.existsSync(this.screenshotDir)) {
      fs.mkdirSync(this.screenshotDir, { recursive: true });
    }
  }

  async capture(name = `screenshot_${Date.now()}`) {
    const screenshot = await this.driver.takeScreenshot();
    const filepath = path.join(this.screenshotDir, `${name}.png`);
    fs.writeFileSync(filepath, screenshot, 'base64');
    return filepath;
  }
}

module.exports = ScreenshotHelper;
