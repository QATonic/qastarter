import * as dotenv from 'dotenv';
import * as path from 'path';
import * as fs from 'fs';

dotenv.config();

export interface Credentials {
  username: string;
  password: string;
}

export interface EnvironmentData {
  baseUrl: string;
  credentials: {
    validUser: Credentials;
    adminUser: Credentials;
  };
  timeout: number;
}

class EnvConfig {
  private environment: string;
  private envData: EnvironmentData;

  constructor() {
    this.environment = process.env.TEST_ENV || 'dev';
    this.envData = this.loadEnvironmentData();
  }

  private loadEnvironmentData(): EnvironmentData {
    const dataPath = path.join(process.cwd(), 'data', `${this.environment}.json`);
    const fileContent = fs.readFileSync(dataPath, 'utf-8');
    return JSON.parse(fileContent) as EnvironmentData;
  }

  public getBaseUrl(): string {
    return this.envData.baseUrl;
  }

  public getCredentials(userType: string): Credentials {
    return this.envData.credentials[userType as keyof typeof this.envData.credentials] || this.envData.credentials.validUser;
  }

  public getTimeout(): number {
    return this.envData.timeout;
  }

  public getEnvironment(): string {
    return this.environment;
  }
}

export default new EnvConfig();
