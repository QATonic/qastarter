/**
 * Login Tests using Playwright.
 */
import { PlaywrightManager } from "../utils/PlaywrightManager";
import { LoginPage } from "../pages/LoginPage";
import { config } from "../config/ConfigReader";

describe("Login Tests", () => {
  let loginPage: LoginPage;

  beforeAll(async () => {
    await PlaywrightManager.initBrowser();
    const page = await PlaywrightManager.getPage();
    await page.goto(config.baseUrl);
    loginPage = new LoginPage();
  });

  afterAll(async () => {
    await PlaywrightManager.closeBrowser();
  });

  beforeEach(async () => {
    const page = await PlaywrightManager.getPage();
    await page.goto(config.baseUrl);
  });

  test("should login successfully with valid credentials", async () => {
    await loginPage.login(config.username, config.password);
    const isSuccess = await loginPage.isLoginSuccessful();
    expect(isSuccess).toBe(true);
  });

  test("should show error with invalid credentials", async () => {
    await loginPage.login("invalid_user", "wrong_password");
    const isError = await loginPage.isErrorDisplayed();
    expect(isError).toBe(true);
  });
});