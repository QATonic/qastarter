import { config as dotenvConfig } from 'dotenv';
import * as fs from 'fs';
import * as path from 'path';
import type { EnvData } from '../types';

dotenvConfig();

class EnvConfig {
  private env: string;
  private envData: EnvData;

  constructor() {
    this.env = process.env.TEST_ENV || 'dev';
    this.envData = this.loadEnvData();
  }

  private loadEnvData(): EnvData {
    const dataPath = path.join(__dirname, '..', 'data', `${this.env}.json`);
    const data = fs.readFileSync(dataPath, 'utf8');
    return JSON.parse(data);
  }

  public getBaseUrl(): string {
    return this.envData.baseUrl;
  }

  public getCredentials(userType: string = 'validUser') {
    return this.envData.credentials[userType];
  }

  public getTimeout(): number {
    return this.envData.timeout || 30000;
  }
}

export default new EnvConfig();
