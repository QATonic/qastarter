/**
* Login Tests using WebdriverIO with TypeScript.
*/
import LoginPage from "../pageobjects/login.page";
import { validUser, invalidUser } from "../data/users";
{{#if utilities.dataProvider}}
import DataReader from "../utils/dataReader";

/**
* Data-driven tests using JSON test data
*/
describe("Data-driven login tests", () => {
const testData = DataReader.getUsers(); // Returns object with keys
const users = Object.values(testData);

users.forEach((user: any) => {
it(`should verify login for user: ${user.username}`, async () => {
await LoginPage.open();
await LoginPage.login(user.username, user.password);

if (user.username === "standard_user") {
await expect(browser).toHaveUrlContaining('inventory');
} else {
await expect(LoginPage.flashMessage).toBeDisplayed();
}
});
});
});
{{/if}}
describe("Login Tests", () => {
beforeEach(async () => {
await LoginPage.open();
});

it("should login successfully with valid credentials", async () => {
await LoginPage.login(validUser.username, validUser.password);

// SauceDemo success check
await expect(browser).toHaveUrlContaining('inventory');
await expect(LoginPage.flashMessage).not.toBeDisplayed();
});

it("should show error with invalid credentials", async () => {
await LoginPage.login(invalidUser.username, invalidUser.password);

// SauceDemo error check
await expect(LoginPage.flashMessage).toBeDisplayed();
await expect(LoginPage.flashMessage).toHaveTextContaining('Epic sadface');
});
});